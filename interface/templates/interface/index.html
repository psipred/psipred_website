{% extends "interface/base.html" %}
{% load bootstrap3 %}
{% load ractive_tags %}
{% load staticfiles %}

{% block content %}
<script id='form_template' type='text/ractive'>
{% templatetag openvariable %}#if results_visible === 2 {% templatetag closevariable %}
<div class="row">
  <div class="col-sm-8">
    <div class="title"><h2>Submission Name : {% ractivetag "name" %}</h2></div>
  </div>
  <div class="col-sm-4">
    <!-- Target -->
    Result Link:<br />
    {% if staging %}
      <input id="retrievalLink" width="160" value="http://bioinf.cs.ucl.ac.uk/psipred_beta/&psipred_uuid={% ractivetag "psipred_uuid" %}">
      <button class="copyButton" type="button" data-clipboard-action="copy" data-clipboard-target="#retrievalLink">
      <img src="http://bioinf.cs.ucl.ac.uk/psipred_beta{% static 'images/clippy.svg %}" alt="Copy to clipboard" width="16">
    {% else %}
      <input id="retrievalLink" width="160" value="http://127.0.0.1:4000/interface/&psipred_uuid={% ractivetag "psipred_uuid" %}">
      <button class="copyButton" type="button" data-clipboard-action="copy" data-clipboard-target="#retrievalLink">
      <img src="../static/images/clippy.svg" alt="Copy to clipboard" width="16">
    {% endif %}
    </button>
    </div>
</div>
{% templatetag openvariable %}/if{% templatetag closevariable %}

<div class="row">
<div class="col-sm-1"><!--Column left-->
  <div class="btn-group-vertical" id="selector" role="group">
    {% templatetag openvariable %}#if results_visible === 2 {% templatetag closevariable %}
      <div class="btn-group-vertical" id="selector" role="group">
      {% templatetag openvariable %}#if psipred_button{% templatetag closevariable %}
        <button on-click='psipred_active' type="button" class="btn btn-default">PSIPRED</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if pgenthreader_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">pGenTHREADER</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if pdomthreader_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">pDomTHREADER</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if disopred_button{% templatetag closevariable %}
        <button on-click='disopred_active' type="button" class="btn btn-default">DISOPRED</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if dompred_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">DomPred</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if memsatsvm_button{% templatetag closevariable %}
        <button on-click='memsatsvm_active' type="button" class="btn btn-default">MEMSAT-SVM</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if mempack_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">MEMPACK</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if ffpred_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">FFPRED</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if bioserf_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">BioSerf</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if domserf_button{% templatetag closevariable %}
        <button type="button" class="btn btn-default">DomSerf</button>
      {% templatetag openvariable %}/if{% templatetag closevariable %}
        <button on-click='downloads_active' type="button" class="btn btn-info">Downloads</button>
      </div>
    {% templatetag openvariable %}/if{% templatetag closevariable %}
  </div>
</div>


  <div class="col-sm-10">
    {% templatetag openvariable %}#if results_visible === 1 {% templatetag closevariable %}
    {# Display a form #}
    <form method="Post" class="form" intro="slide" outro="slide" on-submit="submit">
    {% csrf_token %}

    <div class="form-group">
        <div class="checkbox">
    {% for field in form %}
        {% if "PSIPRED" in field.label %}
            {{ field.errors }}
            {{ field.label_tag }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ field }}
        {% endif %}

        <!--
        {% if "DISOPRED" in field.label %}
            {{ field.errors }}
            {{ field.label_tag }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ field }}
        {% endif %}
        {% if "MEMSAT-SVM" in field.label %}
            {{ field.errors }}
            {{ field.label_tag }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ field }}
        {% endif %}
        -->

    {% endfor %}
        </div>
    </div>
    <p class="form_error">{% ractivehtmltag "form_error" %}</p>
    {% for field in form %}
        {% if "PSIPRED" in field.label or "DISOPRED" in field.label or "MEMSAT-SVM" in field.label %}
        {% else %}
        <div class="form-group">
          {% bootstrap_field field %}
        </div>
        {% endif %}
    {% endfor %}
    <br />

    {% buttons %}
         <input class="btn btn-danger" type="reset" value="Reset" />
         <input value="Submit" type="submit" class="btn btn-primary" />
    {% endbuttons %}
    </form>

    <!-- Annotation panel -->
    {% templatetag openvariable %}elseif results_visible === 2 {% templatetag closevariable %}
    <div class="results" intro="slide" outro="slide" width="100%" >
      <div class="sequence_plot" id="sequence_plot"></div><br />

      <div class="results_panel" width="100%" >
      {% templatetag openvariable %}#if results_panel_visible === 1 {% templatetag closevariable %}
      <div class='psipred_cartoon'></div>
      <div class="waiting" intro="slide" outro="slide">{% ractivehtmltag "psipred_waiting_message" %}</div>
      <div class="waiting_icon" intro="slide" outro="slide">{% ractivehtmltag "psipred_waiting_icon" %}<br />{% ractivehtmltag "psipred_time" %}</div>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if results_panel_visible === 4 {% templatetag closevariable %}
      <h4>Analysis ID: {% ractivetag "disopred_uuid" %}</h4>
      <h5>You can use <a href="http://127.0.0.1:4000/interface/&disopred_uuid={% ractivetag "disopred_uuid" %}">http://127.0.0.1:4000/interface/&#38;disopred_uuid={% ractivetag "disopred_uuid" %}</a> to retrieve this analysis.</h5>
      <div class="waiting" intro="slide" outro="slide">{% ractivehtmltag "disopred_waiting_message" %}</div>
      <div class="waiting_icon" intro="slide" outro="slide">{% ractivehtmltag "disopred_waiting_icon" %}<br />{% ractivehtmltag "disopred_time" %}</div>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if results_panel_visible === 6 {% templatetag closevariable %}
      <h4>Analysis ID: {% ractivetag "memsatsvm_uuid" %}</h4>
      <h5>You can use <a href="http://127.0.0.1:4000/interface/&memsatsvm_uuid={% ractivetag "disopred_uuid" %}">http://127.0.0.1:4000/interface/&#38;memsatsvm_uuid={% ractivetag "memsatsvm_uuid" %}</a> to retrieve this analysis.</h5>
      <div class="waiting" intro="slide" outro="slide">{% ractivehtmltag "memsatsvm_waiting_message" %}</div>
      <div class="waiting_icon" intro="slide" outro="slide">{% ractivehtmltag "memsatsvm_waiting_icon" %}<br />{% ractivehtmltag "memsatsvm_time" %}</div>
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      {% templatetag openvariable %}#if results_panel_visible === 11 {% templatetag closevariable %}
      {% ractivehtmltag "download_links" %}
      {% templatetag openvariable %}/if{% templatetag closevariable %}

      </div><!-- closes results_panel class-->

    </div><!-- closes results class -->
    {% templatetag openvariable %}/if{% templatetag closevariable %}

  </div><!-- closes the col-sm-10 panel -->

  <div class="col-sm-1">
    {% templatetag openvariable %}#if results_visible === 2 {% templatetag closevariable %}
    <h5>Resubmit Segment</h5>
    <form method="Post" class="form" intro="slide" outro="slide" on-submit="resubmit">
    {% csrf_token %}
      <input id="start_coord" class="sequence_coord" value="{% ractivetag "subsequence_start" %}"> - <input id="stop_coord" class="sequence_coord" value="{% ractivetag "subsequence_stop" %}">
      <div class="form-group">
        <div class="checkbox">
          <label for="id_psipred_job">PSIPRED 4.0:</label>
          <input id="id_psipred_job" name="psipred_job" value="psipred_job" type="checkbox" checked="{% ractivetag "psipred_checked" %}">
        </div>
      </div>
      <input value="Resubmit" type="submit" class="btn btn-primary" />
    </form>
    {% templatetag openvariable %}/if{% templatetag closevariable %}
  </div>
</div>  <!--closes the row -->
    </script>
{% endblock content %}
